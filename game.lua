-- title:   game title
-- author:  game developer, email, etc.
-- desc:    short description
-- site:    website link
-- license: MIT License (change this to your license of choice)
-- version: 0.1
-- script:  lua
SW = 240
SH = 136
MENU, GAME, SETTINGS, OVER =
  'M', 'G', 'S', 'O'
GAME_SCREEN = MENU

CARDS = [[
ID:Wellcome
LT:OK
RT:OK
BT:OK
LC:create_foo_bar, 1, 2, 3
RC:blabla, 1, 2
]]

MENU_SCREEN = {
  ['bgc'] = 2, -- Background color
  ['options'] = {'START', 'OPTIONS',
                 'EXIT'},
  ['selected'] = 1,
  ['ic'] = 4, -- Item color
  ['sic'] = 5 -- Selected item color
}


CARDS = {
  ['wellcome'] = {
    ['text'] = 'Wellcome to the game'
  }
}


function MENU_SCREEN:update()
  if btnp(0) then
    self.selected = self.selected - 1
    sfx(1, 64, 6, nil, 8)
  end
  if btnp(1) then
    self.selected = self.selected + 1
    sfx(1, 64, 6, nil, 8)
  end
  if btnp(4) then
    GAME_SCREEN = SETTINGS_SCREEN
  end
  self.selected = self.selected % 4
end

function MENU_SCREEN:draw()
  rect(0, 0, SW, SH, self.bgc)
  spr(1, 0, 0, -1, 1, 0, 0, 4, 4)
  for i, o in ipairs(self.options) do
    local ow = print(o, 320, 0)
    local x = (SW / 2) - (ow / 2)
    local c
    local yo = 0
    if i == self.selected then
      c = self.sic
      yo = 1
    else
      c = self.ic
    end
    print(o, x, (i*20) + 1, 0)
    print(o, x, (i*20) + yo , c)
  end
end

function MENU_SCREEN:tic()
  self:update()
  self:draw()
end

SETTINGS_SCREEN = {
  ['bgc'] = 9,
}

function SETTINGS_SCREEN:update()
end

function SETTINGS_SCREEN:draw()
  rect(0, 0, SW, SH, self.bgc)
end

function SETTINGS_SCREEN:tic()
  SETTINGS_SCREEN:update()
  SETTINGS_SCREEN:draw()
end

music(0)
function TIC()
  if GAME_SCREEN == MENU then
    MENU_SCREEN:tic()
  elseif GAME_SCREEN == SETTINGS_SCREEN then
    SETTINGS_SCREEN:tic()
  end
end

-- <TILES>
-- 001:0000000000000000000000000000000000000000000000020000000200000022
-- 002:0000000000000222002220000220000022000000200000000000000000000000
-- 003:0000000022222200000000200000000200000002000000000000000000000000
-- 004:0000000000000000000000000000000000000000200000002000000020000000
-- 017:0002222000222220020000002002220020222000202020002020200020200200
-- 018:0000000000000000000000000000022200002000000020200000020000000022
-- 019:0000000000000000000000000000002020000202200002022000020200000020
-- 020:2000000022000000022222000220002002202020002020200022002000220020
-- 033:2020002020022000020002200022000000002200000000200000000200000000
-- 034:0000000000000000000000000000000000000000000000000000000020000000
-- 035:0000000000000000002002000022200000000000000000000000000000220000
-- 036:0022020000200200000220000002000000020000000200000002000000020000
-- 050:0200000002000000002200000000222200000000000000000000000000000000
-- 051:0022000000000000000000002222222200000000000000000000000000000000
-- 052:0020000002000000020000002000000000000000000000000000000000000000
-- </TILES>

-- <WAVES>
-- 000:55667788888776655533211123355555
-- 001:444444456789abbbccbbbaa988777665
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:00c000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000307000000000
-- 001:00e00090007000300000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000007000000000
-- 002:03006300d300f300f300f300f300f300f300f30003000300030003000300030003000300030003000300030003000300030003000300030003000300000000330000
-- </SFX>

-- <PATTERNS>
-- 000:680504000000000000000000800004100000000000000000800004100000000000000000600004000000000000000000800004100000000000000000000000000000000000000000600004000000000000000000800004100000000000000000800004100000000000000000900004000020000000000400800004100000000000000000000000000000000000000000100000000000000000000000800004100000000000000000600004100000000000000000600004000000000000000000
-- 001:600006000000000000000000800006100000000000000000000000000000100000000000f00006000000000000000000d00006100000000000000000000000000000000000000000600006000000000000000000800006100000000000000000000000000000000000000000d00006000000000000000000b00006100000000000000000000000000000000000000000600006100000000000000000800006100000000000000000000000000000000000000000a00006000000000000000000
-- 002:b00006000000000000000000a00006000000000000000000600006000000000000000000800006000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00006000000000000000000b00006000000000000000000a00006000000000000000000600006000000000000000000
-- 003:600004100000000000000000000000000000000000000000600004100000000000000000800004100000000000000000800004100000000000000000600004000000000000000000800004100000000000000000000000000000000000000000000000000000000000020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:a44124000020a1112a100020a3312a000020100020a0002aa0002a100020a1112a000000a44124100020a1112a000000a3312a100020000000a0002aa0002a100020a1112a000000a44124000000a1112a000000a3312a000000000000a0002aa0002a000000a1112a000000a44124a0002aa1112a000000a3312a000000100020a1122aa0002a000000a1112a100020a44124000020a1112a100020a3312a000000000000a0002aa0002a000000a3312a100020a00024000020a00024000000
-- 005:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020300020300020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </PATTERNS>

-- <TRACKS>
-- 000:1005004005001805004c0500000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </TRACKS>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

